<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no, maximum-scale=1">
  <title>Regalo de Girasoles ðŸŒ»</title>
  <style>
    :root {
      --bg-color: #fffbf6;
      --yellow: #ffe066;
      --orange: #ffd166;
      --sunflower: #FFD700;
      --brown: #a67c52;
      --shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: var(--bg-color);
      font-family: 'Segoe UI', 'Arial', sans-serif;
      overflow-x: hidden;
      width: 100vw;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      position: relative;
    }
    .container {
      width: 100vw;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      position: relative;
      padding-bottom: 10vh;
    }
    .top-image {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100vw;
      margin: 0 0 12px 0;
      z-index: 3;
      pointer-events: none;
      user-select: none;
    }
    .top-image img {
      width: 64px;
      max-width: 28vw;
      filter: drop-shadow(0 2px 18px #ffe06699);
      animation: topSunflowerAppear 1.3s cubic-bezier(.32,1.35,.34,1.01);
      border-radius: 22%;
    }
    @keyframes topSunflowerAppear {
      0% { opacity: 0; transform: scale(.7) translateY(-32px);}
      70% { opacity: 1; transform: scale(1.1) translateY(6px);}
      100% { opacity: 1; transform: scale(1) translateY(0);}
    }
    .sunflowers-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: end;
      gap: 4vw;
      margin-bottom: 24px;
      width: 98vw;
      min-height: 60px;
      position: relative;
      z-index: 2;
      padding: 0 1vw;
    }
    .sunflower-emoji {
      font-size: 1.65rem;
      animation: floatSunflower 2.3s ease-in-out infinite;
      filter: drop-shadow(0 0 8px #ffd70080);
      position: relative;
      margin: 0 1vw;
      flex-shrink: 0;
    }
    .sunflower-emoji:nth-child(2n) {
      animation-duration: 2.1s;
      animation-delay: 0.32s;
    }
    .sunflower-emoji:nth-child(3n) {
      animation-duration: 1.8s;
      animation-delay: 0.54s;
    }
    .sunflower-emoji:nth-child(4n) {
      animation-duration: 2.4s;
      animation-delay: 0.14s;
    }
    .sunflower-emoji:nth-child(5n) {
      animation-duration: 2.7s;
      animation-delay: 0.75s;
    }
    @keyframes floatSunflower {
      0% { transform: translateY(0) scale(1) rotate(-8deg);}
      20% { filter: brightness(1.2) drop-shadow(0 0 12px #ffd700a0);}
      50% { transform: translateY(-8px) scale(1.08) rotate(8deg);}
      80% { filter: brightness(1.15);}
      100% { transform: translateY(0) scale(1) rotate(-8deg);}
    }
    .sparkle {
      position: absolute;
      pointer-events: none;
      animation: sparkleFade 1.2s linear infinite;
      opacity: 0.8;
    }
    @keyframes sparkleFade {
      0%,100% { opacity: 0; transform: scale(0.4);}
      25% { opacity: 1; transform: scale(1.1);}
      70% { opacity: 0.9; }
      85% { opacity: 0.4; }
    }
    .envelope-btn {
      background: none;
      border: none;
      outline: none;
      cursor: pointer;
      font-size: 2.3rem;
      margin: 0 0.5rem;
      transition: transform 0.11s;
      z-index: 3;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.2rem 0.4rem;
      box-sizing: border-box;
      touch-action: manipulation;
    }
    .envelope-btn:active {
      transform: scale(1.09);
    }
    .envelope-label {
      font-size: 0.98rem;
      margin-top: 0.09rem;
      color: #8c5336;
      letter-spacing: .02em;
      text-shadow: 0 1px 4px #fff8e1;
      font-weight: 500;
      user-select: none;
    }
    .message-popup {
      position: fixed;
      left: 50%;
      bottom: 4.5vh;
      transform: translate(-50%,0);
      background: #fffbe9ee;
      box-shadow: var(--shadow),0 0 0 6px #ffe06622;
      border-radius: 1.1rem;
      max-width: 96vw;
      min-width: 0;
      width: 92vw;
      padding: 1.4rem 1rem 1rem 1rem;
      font-size: 1.04rem;
      line-height: 1.62;
      color: #7d5429;
      z-index: 100;
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
      font-family: inherit;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 1.2px solid #ffe06690;
      word-break: break-word;
      box-sizing: border-box;
    }
    .message-popup.active {
      opacity: 1;
      pointer-events: auto;
      animation: popupBounce 0.6s cubic-bezier(.32,1.35,.34,1.01) 1;
    }
    @keyframes popupBounce {
      0% { transform: translate(-50%,70px) scale(.92);}
      60% { transform: translate(-50%,-8px) scale(1.04);}
      100% { transform: translate(-50%,0) scale(1);}
    }
    .close-btn {
      background: none;
      border: none;
      font-size: 1.45rem;
      color: #ffb200;
      margin-top: 0.4rem;
      cursor: pointer;
      transition: transform 0.11s;
      filter: drop-shadow(0 0 5px #ffe06688);
      padding: 0.15rem 0.5rem;
      border-radius: 0.7rem;
      touch-action: manipulation;
    }
    .close-btn:active {
      transform: scale(1.12);
      background: #ffe0662c;
    }
    /* Sunflower rain */
    .sunflower-rain {
      pointer-events: none;
      z-index: 10000;
      position: fixed;
      left:0; top:0; width:100vw; height:100vh;
      overflow:visible;
      display: block;
    }
    .rain-sunflower {
      position: absolute;
      font-size: 1.15rem;
      will-change: transform, opacity;
      opacity: 1;
      filter: drop-shadow(0 0 8px #ffd70080);
      animation: sunflowerRainFall 1.1s cubic-bezier(.55,0,.64,1) forwards;
      user-select: none;
    }
    @keyframes sunflowerRainFall {
      0% {
        opacity: 0;
        transform: translateY(-20px) scale(0.7) rotate(-10deg);
      }
      12% { opacity: 1;}
      60% {
        opacity: 1;
        transform: translateY(62vh) scale(1.08) rotate(13deg);
      }
      95% {
        opacity: 0.85;
      }
      100% {
        opacity: 0;
        transform: translateY(93vh) scale(1.1) rotate(18deg);
      }
    }
    /* Hide scrollbars and prevent overscroll glow */
    html, body {
      overscroll-behavior: none;
      scrollbar-width: none;
    }
    ::-webkit-scrollbar { display: none; }

    /* Mobile optimization */
    @media (max-width: 480px) {
      .container { padding-bottom: 5vh; }
      .top-image img { width: 44px; max-width: 22vw;}
      .sunflowers-row { min-height: 36px; gap: 2vw; }
      .sunflower-emoji { font-size: 1.12rem; margin: 0 0.7vw; }
      .message-popup { font-size: 0.97rem; padding: 1.05rem 0.7rem 0.8rem 0.7rem; width: 97vw; }
      .envelope-label { font-size: 0.91rem; }
      .envelope-btn { font-size: 1.7rem; }
      .rain-sunflower { font-size: 0.87rem; }
      .close-btn { font-size: 1.1rem; }
    }
    @media (max-width: 350px) {
      .message-popup { font-size: 0.93rem; }
      .top-image img { width: 30px; }
    }
    /* Prevent tap highlight */
    *:focus { outline: none !important; }
  </style>
</head>
<body>
  <div class="container">
    <div class="top-image">
      <img src="pinguinos.png" alt="Pinguino real bonito">
    </div>
    <div class="sunflowers-row" id="sunflowersRow">
      <!-- Sunflower emojis and envelope will be inserted via JS -->
    </div>
    <button class="envelope-btn" id="envelopeBtn" aria-label="Haz clic para abrir el mensaje" role="button" tabindex="0">
      <span style="font-size: 2.3rem;" id="envelopeEmoji">ðŸ’Œ</span>
      <span class="envelope-label">Tu mensaje</span>
    </button>
  </div>

  <div class="message-popup" id="messagePopup" aria-label="Mensaje especial" tabindex="-1">
    <div style="width:100%;">
      QuizÃ¡ no pueda obsequiarte girasoles reales, pero no quiero que te quedes sin tus flores.<br>
      Hoy te obsequio estos girasoles virtuales ðŸŒ» y por mÃ¡s que no estÃ©n en fÃ­sico, siempre tratarÃ© de darte lo mejor que pueda.<br>
      <b>Besito ðŸ’•</b>
    </div>
    <button class="close-btn" onclick="closeMessage()" aria-label="Cerrar mensaje">âœ•</button>
  </div>

  <!-- Capa para la lluvia de girasoles -->
  <div class="sunflower-rain" id="sunflowerRain"></div>

  <script>
    // SUNFLOWERS + SPARKLES
    const sunflowersRow = document.getElementById('sunflowersRow');
    const envelopeBtn = document.getElementById('envelopeBtn');
    const envelopeEmoji = document.getElementById('envelopeEmoji');
    const isMobile = window.innerWidth <= 480;
    // Reduce number for small screens
    const sunflowerCount = isMobile ?
      Math.max(7, Math.floor(window.innerWidth / 34)) :
      Math.max(12, Math.floor(window.innerWidth / 38));
    const sunflowerEmojis = [];
    for(let i=0;i<sunflowerCount;i++){
      const sf = document.createElement('span');
      sf.className = 'sunflower-emoji';
      sf.textContent = 'ðŸŒ»';
      sf.style.left = (Math.random()*3-1.5)+'px';
      sf.style.top = (Math.random()*1.5-0.5)+'px';
      sunflowersRow.appendChild(sf);

      // Add some random sparkles to some sunflowers
      if(Math.random()<0.5) {
        const sparkle = document.createElement('span');
        sparkle.className = 'sparkle';
        sparkle.textContent = 'âœ¨';
        // Place sparkle over the sunflower
        sparkle.style.left = (5 + Math.random()*11)+'px';
        sparkle.style.top = (-4 + Math.random()*5)+'px';
        sparkle.style.fontSize = (0.86+Math.random()*0.36)+'rem';
        sparkle.style.color = '#ffe066';
        // Animation delay so they don't all sparkle at once
        sparkle.style.animationDelay = (Math.random()*1.2)+'s';
        sf.style.position = 'relative';
        sf.appendChild(sparkle);
      }
      sunflowerEmojis.push(sf);
    }

    // ENVELOPE BUTTON in the middle
    setTimeout(()=>{
      // Insert envelope in the middle
      const mid = Math.floor(sunflowerEmojis.length/2);
      sunflowersRow.insertBefore(envelopeBtn, sunflowerEmojis[mid]);
    }, 80);

    // --- SUNFLOWER RAIN LOGIC ---
    const sunflowerRain = document.getElementById('sunflowerRain');
    function launchSunflowerRain() {
      // Cantidad de girasoles que caen
      const rainAmount = isMobile ? Math.floor(7 + Math.random()*4) : Math.floor(14 + Math.random()*9);
      for(let i=0;i<rainAmount;i++) {
        setTimeout(()=>{
          createRainSunflower();
        }, Math.random()*700);
      }
    }
    function createRainSunflower() {
      const emoji = document.createElement('span');
      emoji.className = 'rain-sunflower';
      emoji.textContent = 'ðŸŒ»';
      // PosiciÃ³n horizontal aleatoria (10vw a 90vw)
      emoji.style.left = (5 + Math.random()*90) + 'vw';
      emoji.style.top = '-2vh';
      // Variar ligeramente el tamaÃ±o y la rotaciÃ³n
      const s = isMobile ? (0.87 + Math.random()*0.19) : (0.95 + Math.random()*0.25);
      emoji.style.fontSize = (isMobile ? 0.87 : 1.15)*s + 'rem';
      emoji.style.transform = `scale(${s}) rotate(${Math.random()*22-11}deg)`;

      sunflowerRain.appendChild(emoji);

      // Remover despuÃ©s de animar
      emoji.addEventListener('animationend', () => {
        emoji.remove();
      });
    }

    // MESSAGE POPUP LOGIC
    const messagePopup = document.getElementById('messagePopup');
    envelopeBtn.onclick = function() {
      messagePopup.classList.add('active');
      setTimeout(()=>{
        // Focus for accessibility; will not scroll the page
        messagePopup.focus({preventScroll:true});
      }, 120);
      launchSunflowerRain();
    };
    function closeMessage() {
      messagePopup.classList.remove('active');
    }
    window.closeMessage = closeMessage;
    // Close popup on background tap
    document.addEventListener('click', function(e){
      if(messagePopup.classList.contains('active') &&
         !messagePopup.contains(e.target) &&
         e.target!==envelopeBtn && e.target!==envelopeEmoji) {
        closeMessage();
      }
    });

    // Prevent scrolling when popup is open (for mobile)
    document.addEventListener('touchmove', function(e){
      if(messagePopup.classList.contains('active')) {
        e.preventDefault();
      }
    }, {passive:false});

    // Prevent double-tap zoom on mobile
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(e) {
      const now = new Date().getTime();
      if (now - lastTouchEnd <= 350) {
        e.preventDefault();
      }
      lastTouchEnd = now;
    }, false);

    // Prevent pinch-zoom
    document.addEventListener('gesturestart', function (e) {
      e.preventDefault();
    }, {passive:false});
  </script>
</body>
</html>
