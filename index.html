<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Regalo de Girasoles ðŸŒ»</title>
  <style>
    :root {
      --bg-color: #fffbf6;
      --yellow: #ffe066;
      --orange: #ffd166;
      --sunflower: #FFD700;
      --brown: #a67c52;
      --shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: var(--bg-color);
      font-family: 'Segoe UI', 'Arial', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      overflow-x: hidden;
      position: relative;
    }
    .container {
      width: 100vw;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      position: relative;
      padding-bottom: 10vh;
    }
    .top-image {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100vw;
      margin: 0 0 20px 0;
      z-index: 3;
      pointer-events: none;
      user-select: none;
    }
    .top-image img {
      width: 90px;
      max-width: 30vw;
      filter: drop-shadow(0 2px 18px #ffe06699);
      animation: topSunflowerAppear 1.3s cubic-bezier(.32,1.35,.34,1.01);
    }
    @keyframes topSunflowerAppear {
      0% { opacity: 0; transform: scale(.7) translateY(-32px);}
      70% { opacity: 1; transform: scale(1.1) translateY(6px);}
      100% { opacity: 1; transform: scale(1) translateY(0);}
    }

    .sunflowers-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: end;
      gap: 8px;
      margin-bottom: 40px;
      width: 95vw;
      min-height: 120px;
      position: relative;
      z-index: 2;
    }
    .sunflower-emoji {
      font-size: 2.7rem;
      animation: floatSunflower 3s ease-in-out infinite;
      filter: drop-shadow(0 0 8px #ffd70080);
      position: relative;
    }
    .sunflower-emoji:nth-child(2n) {
      animation-duration: 2.7s;
      animation-delay: 0.5s;
    }
    .sunflower-emoji:nth-child(3n) {
      animation-duration: 2.3s;
      animation-delay: 0.8s;
    }
    .sunflower-emoji:nth-child(4n) {
      animation-duration: 2.9s;
      animation-delay: 0.2s;
    }
    .sunflower-emoji:nth-child(5n) {
      animation-duration: 3.4s;
      animation-delay: 1s;
    }
    @keyframes floatSunflower {
      0% { transform: translateY(0) scale(1) rotate(-8deg);}
      20% { filter: brightness(1.2) drop-shadow(0 0 12px #ffd700a0);}
      50% { transform: translateY(-18px) scale(1.1) rotate(8deg);}
      80% { filter: brightness(1.15);}
      100% { transform: translateY(0) scale(1) rotate(-8deg);}
    }

    .sparkle {
      position: absolute;
      pointer-events: none;
      animation: sparkleFade 1.6s linear infinite;
      opacity: 0.8;
    }
    @keyframes sparkleFade {
      0%,100% { opacity: 0; transform: scale(0.4);}
      25% { opacity: 1; transform: scale(1.1);}
      70% { opacity: 0.9; }
      85% { opacity: 0.4; }
    }

    .envelope-btn {
      background: none;
      border: none;
      outline: none;
      cursor: pointer;
      font-size: 3.2rem;
      margin: 0 0.5rem;
      transition: transform 0.11s;
      z-index: 3;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .envelope-btn:active {
      transform: scale(1.09);
    }
    .envelope-label {
      font-size: 1.05rem;
      margin-top: 0.2rem;
      color: #8c5336;
      letter-spacing: .03em;
      text-shadow: 0 1px 4px #fff8e1;
      font-weight: 500;
    }

    .message-popup {
      position: fixed;
      left: 50%;
      bottom: 12vh;
      transform: translate(-50%,0);
      background: #fffbe9ee;
      box-shadow: var(--shadow),0 0 0 6px #ffe06622;
      border-radius: 1.5rem;
      max-width: 90vw;
      padding: 2.3rem 1.2rem 1.5rem 1.2rem;
      font-size: 1.1rem;
      line-height: 1.7;
      color: #7d5429;
      z-index: 100;
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
      font-family: inherit;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 1.5px solid #ffe06699;
    }
    .message-popup.active {
      opacity: 1;
      pointer-events: auto;
      animation: popupBounce 0.7s cubic-bezier(.32,1.35,.34,1.01) 1;
    }
    @keyframes popupBounce {
      0% { transform: translate(-50%,70px) scale(.8);}
      60% { transform: translate(-50%,-12px) scale(1.04);}
      100% { transform: translate(-50%,0) scale(1);}
    }
    .close-btn {
      background: none;
      border: none;
      font-size: 2rem;
      color: #ffb200;
      margin-top: 0.7rem;
      cursor: pointer;
      transition: transform 0.11s;
      filter: drop-shadow(0 0 6px #ffe06688);
    }
    .close-btn:active {
      transform: scale(1.15);
    }

    /* Sunflower rain */
    .sunflower-rain {
      pointer-events: none;
      z-index: 10000;
      position: fixed;
      left:0; top:0; width:100vw; height:100vh;
      overflow:visible;
      display: block;
      pointer-events: none;
    }
    .rain-sunflower {
      position: absolute;
      font-size: 2.2rem;
      will-change: transform, opacity;
      opacity: 1;
      filter: drop-shadow(0 0 8px #ffd70080);
      animation: sunflowerRainFall 1.7s cubic-bezier(.55,0,.64,1) forwards;
    }
    @keyframes sunflowerRainFall {
      0% {
        opacity: 0; 
        transform: translateY(-30px) scale(0.7) rotate(-10deg);
      }
      12% { opacity: 1;}
      60% {
        opacity: 1;
        transform: translateY(70vh) scale(1.1) rotate(13deg);
      }
      95% {
        opacity: 0.85;
      }
      100% {
        opacity: 0;
        transform: translateY(100vh) scale(1.1) rotate(18deg);
      }
    }

    /* Mobile - extra touch */
    @media (max-width: 600px) {
      .container { padding-bottom: 6vh; }
      .sunflowers-row { min-height: 80px; }
      .sunflower-emoji { font-size: 2.1rem; }
      .top-image img { width: 52px; }
      .message-popup { font-size: 1rem; padding: 1.5rem 1rem 1rem 1rem;}
      .rain-sunflower { font-size: 1.4rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="top-image">
      <img src="girasol.png" alt="Girasol real bonito">
    </div>
    <div class="sunflowers-row" id="sunflowersRow">
      <!-- Sunflower emojis and envelope will be inserted via JS -->
    </div>
    <button class="envelope-btn" id="envelopeBtn" aria-label="Haz clic para abrir el mensaje" role="button">
      <span style="font-size: 3.2rem;" id="envelopeEmoji">ðŸ’Œ</span>
      <span class="envelope-label">Tu mensaje</span>
    </button>
  </div>

  <div class="message-popup" id="messagePopup" aria-label="Mensaje especial">
    <div>
      QuizÃ¡ no pueda obsequiarte girasoles reales, pero no quiero que te quedes sin tus flores.<br>
      Hoy te obsequio estos girasoles virtuales ðŸŒ» y por mÃ¡s que no estÃ©n en fÃ­sico, siempre tratarÃ© de darte lo mejor que pueda.<br>
      <b>Besito ðŸ’•</b>
    </div>
    <button class="close-btn" onclick="closeMessage()" aria-label="Cerrar mensaje">âœ•</button>
  </div>

  <!-- Capa para la lluvia de girasoles -->
  <div class="sunflower-rain" id="sunflowerRain"></div>

  <script>
    // SUNFLOWERS + SPARKLES
    const sunflowersRow = document.getElementById('sunflowersRow');
    const envelopeBtn = document.getElementById('envelopeBtn');
    const envelopeEmoji = document.getElementById('envelopeEmoji');
    const sunflowerCount = Math.max(12, Math.floor(window.innerWidth / 38));
    const sunflowerEmojis = [];
    for(let i=0;i<sunflowerCount;i++){
      const sf = document.createElement('span');
      sf.className = 'sunflower-emoji';
      sf.textContent = 'ðŸŒ»';
      sf.style.left = (Math.random()*4-2)+'px';
      sf.style.top = (Math.random()*2-1)+'px';
      sunflowersRow.appendChild(sf);

      // Add some random sparkles to some sunflowers
      if(Math.random()<0.55) {
        const sparkle = document.createElement('span');
        sparkle.className = 'sparkle';
        sparkle.textContent = 'âœ¨';
        // Place sparkle over the sunflower
        sparkle.style.left = (8 + Math.random()*12)+'px';
        sparkle.style.top = (-6 + Math.random()*6)+'px';
        sparkle.style.fontSize = (1.1+Math.random()*0.5)+'rem';
        sparkle.style.color = '#ffe066';
        // Animation delay so they don't all sparkle at once
        sparkle.style.animationDelay = (Math.random()*1.4)+'s';
        sf.style.position = 'relative';
        sf.appendChild(sparkle);
      }
      sunflowerEmojis.push(sf);
    }

    // ENVELOPE BUTTON in the middle
    setTimeout(()=>{
      // Insert envelope in the middle
      const mid = Math.floor(sunflowerEmojis.length/2);
      sunflowersRow.insertBefore(envelopeBtn, sunflowerEmojis[mid]);
    }, 120);

    // --- SUNFLOWER RAIN LOGIC ---
    const sunflowerRain = document.getElementById('sunflowerRain');
    function launchSunflowerRain() {
      // Cantidad de girasoles que caen
      const rainAmount = Math.floor(14 + Math.random()*9);
      for(let i=0;i<rainAmount;i++) {
        setTimeout(()=>{
          createRainSunflower();
        }, Math.random()*800);
      }
    }
    function createRainSunflower() {
      const emoji = document.createElement('span');
      emoji.className = 'rain-sunflower';
      emoji.textContent = 'ðŸŒ»';
      // PosiciÃ³n horizontal aleatoria (10vw a 90vw)
      emoji.style.left = (8 + Math.random()*84) + 'vw';
      emoji.style.top = '-3vh';
      // Variar ligeramente el tamaÃ±o y la rotaciÃ³n
      const s = 0.95 + Math.random()*0.25;
      emoji.style.fontSize = (window.innerWidth < 600 ? 1.2 : 2.1)*s + 'rem';
      emoji.style.transform = `scale(${s}) rotate(${Math.random()*24-12}deg)`;

      sunflowerRain.appendChild(emoji);

      // Remover despuÃ©s de animar
      emoji.addEventListener('animationend', () => {
        emoji.remove();
      });
    }

    // MESSAGE POPUP LOGIC
    const messagePopup = document.getElementById('messagePopup');
    envelopeBtn.onclick = function() {
      messagePopup.classList.add('active');
      setTimeout(()=>{
        // Focus for accessibility; will not scroll the page
        messagePopup.focus({preventScroll:true});
      }, 160);
      launchSunflowerRain();
    };
    function closeMessage() {
      messagePopup.classList.remove('active');
    }
    window.closeMessage = closeMessage;
    // Close popup on background tap
    document.addEventListener('click', function(e){
      if(messagePopup.classList.contains('active') &&
         !messagePopup.contains(e.target) &&
         e.target!==envelopeBtn && e.target!==envelopeEmoji) {
        closeMessage();
      }
    });

    // Prevent scrolling when popup is open (for mobile)
    document.addEventListener('touchmove', function(e){
      if(messagePopup.classList.contains('active')) {
        e.preventDefault();
      }
    }, {passive:false});
  </script>
</body>
</html>
